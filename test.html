<!-- FULL DOCUMENT REWRITTEN WITH FIXED `icons` VARIABLE (removed duplicate declaration) -->

<script src="https://cdn.tailwindcss.com"></script>
<style>
/* From Uiverse.io by pharmacist-sabot */
    :root {
      --win95-bg: #008080;
      --win95-window: #c0c0c0;
      --win95-border-light: #ffffff;
      --win95-border-dark: #000000;
      --win95-border-mid: #808080;
      --win95-titlebar: #000080;
      --win95-titlebar-text: #ffffff;
      --win95-button-face: #c0c0c0;
      --win95-button-text: #000000;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: var(--win95-bg);
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      font-size: 14px;
      color: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    .win95-card {
      background: var(--win95-window);
      min-width: 320px;
      max-width: 420px;
      border: 2px solid var(--win95-border-dark);
      box-shadow:
        1px 1px 0 var(--win95-border-dark),
        -1px -1px 0 var(--win95-border-light);
    }

    /* Title bar */

    .win95-card__titlebar {
      background: var(--win95-titlebar);
      color: var(--win95-titlebar-text);
      padding: 3px 4px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--win95-border-dark);
    }

    .win95-card__title-left {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .win95-card__icon {
      width: 16px;
      height: 16px;
      background:
        linear-gradient(135deg, #ffffff 25%, #000080 25% 50%, #008080 50% 75%, #808080 75%);
      border: 1px solid #000000;
    }

    .win95-card__title-text {
      font-size: 13px;
      font-weight: bold;
      white-space: nowrap;
    }

    .win95-card__title-buttons {
      display: flex;
      gap: 2px;
    }

    .win95-btn-title {
      width: 18px;
      height: 18px;
      background: var(--win95-button-face);
      border-top: 1px solid var(--win95-border-light);
      border-left: 1px solid var(--win95-border-light);
      border-right: 1px solid var(--win95-border-dark);
      border-bottom: 1px solid var(--win95-border-dark);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      line-height: 1;
      cursor: default;
    }

    /* Card body */

    .win95-card__body {
      padding: 10px 10px 6px;
      border-top: 1px solid var(--win95-border-light);
      border-left: 1px solid var(--win95-border-light);
      border-right: 1px solid var(--win95-border-mid);
      border-bottom: 1px solid var(--win95-border-mid);
    }

    .win95-card__section-label {
      font-size: 12px;
      margin-bottom: 6px;
    }

    .win95-card__fieldset {
      border-top: 2px solid var(--win95-border-light);
      border-left: 2px solid var(--win95-border-light);
      border-right: 2px solid var(--win95-border-dark);
      border-bottom: 2px solid var(--win95-border-dark);
      padding: 8px;
      background: var(--win95-window);
    }

    .win95-card__row {
      display: grid;
      grid-template-columns: 110px 1fr;
      gap: 4px 8px;
      font-size: 12px;
      margin-bottom: 4px;
    }

    .win95-card__row-label {
      text-align: right;
      padding-right: 4px;
      white-space: nowrap;
    }

    .win95-card__row-value {
      background: #ffffff;
      border-top: 1px solid var(--win95-border-dark);
      border-left: 1px solid var(--win95-border-dark);
      border-right: 1px solid var(--win95-border-light);
      border-bottom: 1px solid var(--win95-border-light);
      padding: 2px 4px;
    }

    /* Footer buttons */

    .win95-card__footer {
      display: flex;
      justify-content: flex-end;
      gap: 6px;
      padding: 8px 10px 10px;
    }

    .win95-btn {
      min-width: 80px;
      padding: 2px 10px;
      font-size: 12px;
      background: var(--win95-button-face);
      color: var(--win95-button-text);
      border-top: 2px solid var(--win95-border-light);
      border-left: 2px solid var(--win95-border-light);
      border-right: 2px solid var(--win95-border-dark);
      border-bottom: 2px solid var(--win95-border-dark);
      cursor: default;
    }

    .win95-btn:active {
      border-top: 2px solid var(--win95-border-dark);
      border-left: 2px solid var(--win95-border-dark);
      border-right: 2px solid var(--win95-border-light);
      border-bottom: 2px solid var(--win95-border-light);
      padding-top: 3px;
      padding-left: 11px;
      padding-bottom: 1px;
      padding-right: 9px;
    }
.win98-container { width: 30rem; margin: 2rem auto; font-family: "Tahoma", "Pixelated MS Sans Serif", sans-serif; position: absolute; isolation: isolate; }
:root { --win98-blue:#1C386A; --win98-light:#A4D9C0; --win98-dark:#101D3D; --win98-white:#FFFFFF; --win98-black:#000000; }
.win98-window { background: var(--win98-light); opacity: 1 !important; backdrop-filter: none !important; border:2px solid; border-color:var(--win98-white) var(--win98-dark) var(--win98-dark) var(--win98-white); position:absolute; z-index:10; transition:none;}
.win98-titlebar { background:linear-gradient(to right,var(--win98-blue),#0a248a); color:white; padding:3px 2px; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid var(--win98-dark); z-index:20; }
.win98-title { font-size:0.8rem; font-weight:bold; margin-left:2px; letter-spacing:0.5px; }
.win98-controls { display:flex; gap:2px; margin-right:2px; }
.win98-button { width:16px; height:14px; background:var(--win98-light); border:1px solid; border-color:var(--win98-white) var(--win98-dark) var(--win98-dark) var(--win98-white); display:flex; align-items:center; justify-content:center; font-size:0.7rem; font-weight:bold; cursor:pointer; user-select:none; }
.win98-button:active { border-color:var(--win98-dark) var(--win98-white) var(--win98-white) var(--win98-dark); padding:1px 0 0 1px; }
.win98-content { padding:8px; background: var(--win98-light); }
.win98-menu-bar { background: var(--win98-light); opacity:1 !important; display:flex; gap:15px; margin-bottom:10px; padding:2px 5px; border:1px solid; border-color:var(--win98-white) var(--win98-dark) var(--win98-dark) var(--win98-white); }
.win98-menu-item { font-size:0.8rem; cursor:pointer; padding:1px 3px; }
.win98-menu-item:hover { background:var(--win98-blue); color:white; }
.win98-input-frame { display:flex; align-items:center; gap:8px; margin-bottom:15px; }
.win98-input-label { font-size:0.8rem; font-weight:bold; min-width:40px; }
.win98-input { flex:1; height:22px; background: var(--win98-white); opacity:1 !important; border:2px solid; border-color:var(--win98-white) var(--win98-dark) var(--win98-dark) var(--win98-white); font-family:"Tahoma"; font-size:0.8rem; padding:0 3px; outline:none; }
.win98-input:focus { background:#ffffe0; }
.win98-status-bar { display:flex; justify-content:space-between; align-items:center; background:var(--win98-dark); opacity:1 !important; color:white; padding:2px 5px; font-size:0.7rem; border-top:1px solid var(--win98-white); min-height:18px; }
.win98-status-indicators { display:flex; gap:5px; }
.win98-indicator { background:var(--win98-white); color:var(--win98-black); padding:0 3px; border:1px solid; border-color:var(--win98-white) var(--win98-dark) var(--win98-dark) var(--win98-white); font-weight:bold; }
.win98-resize-handle { position:absolute; bottom:0; right:0; width:15px; height:15px; background:linear-gradient(135deg, transparent 0%, transparent 50%, var(--win98-dark) 50%, var(--win98-dark) 60%, transparent 60%); cursor:nw-resize; }
.graph-box,.odds-box { background: var(--win98-light); border:2px solid; border-color:var(--win98-white) var(--win98-dark) var(--win98-dark) var(--win98-white); padding:6px; margin-top:10px; opacity:1 !important; }
.graph-box { height:150px; }
.odds-box h3 { margin:0 0 4px 0; font-size:0.85rem; }
.desktop-icon.selected span { background:#000080; color:#fff; padding:1px 3px; }
.selection-box { position:absolute; border:1px dotted #fff; background:rgba(0,120,215,0.25); pointer-events:none; }
.desktop-icon:hover span { outline: 1px dotted #ffffff; background: #000080; color: white; }
.desktop-icon:not(.selected):active span { background: #000080; color: white; }
.desktop-icon span { background: var(--win98-light) !important; }

.win98-window .win98-input { background: var(--win98-white) !important; }
.win98-window .win98-status-bar { background: var(--win98-dark) !important; }
.win98-window .win98-titlebar { background: linear-gradient(to right,var(--win98-blue),#0a248a) !important; }
.win98-window .win98-resize-handle { background: linear-gradient(135deg, transparent 0%, transparent 50%, var(--win98-dark) 50%, var(--win98-dark) 60%, transparent 60%) !important; }
</style>

<div class="desktop bg-[#008080] w-full h-screen relative overflow-hidden select-none">

  $1
    <!-- Gacha Program Manager Icon -->
    <div class="desktop-icon flex flex-col items-center w-20 cursor-pointer" data-window="win-gacha">
      <img src="/icon-folder.png" class="w-10 h-10" />
      <span>Gacha Calc</span>
    </div>

    <!-- Results Program Manager Icon -->
    <div class="desktop-icon flex flex-col items-center w-20 cursor-pointer" data-window="win-results">
      <img src="/icon-folder.png" class="w-10 h-10" />
      <span>Results</span>
    </div>
  $2

  <div id="win-gacha" style="display:none;" data-state="minimized" class="win98-window absolute top-32 left-32 w-[260px] h-[310px] shadow-xl">
    <div class="win98-titlebar">
      <div class="win98-title">GACHA - PROGRAM MANAGER</div>
      <div class="win98-controls">
        <div class="win98-button win98-minimize">_</div>
        <div class="win98-button win98-maximize">□</div>
        <div class="win98-button win98-close">×</div>
      </div>
    </div>
    <div class="win98-content">
      <div class="win98-menu-bar"><span class="win98-menu-item">File</span><span class="win98-menu-item">Edit</span><span class="win98-menu-item">View</span><span class="win98-menu-item">Help</span></div>
      <div class="win98-input-frame"><span class="win98-input-label">Disabled:</span><input class="win98-input" type="number" /></div>
      <div class="win98-input-frame"><span class="win98-input-label">Left:</span><input class="win98-input" type="number" /></div>
      <div class="win98-input-frame"><span class="win98-input-label">OG:</span><input class="win98-input" type="number" /></div>
      <div class="win98-input-frame"><span class="win98-input-label">Tuto:</span><input class="win98-input" type="number" /></div>
      <div class="win98-input-frame"><span class="win98-input-label">Pers:</span><input class="win98-input" type="number" /></div>
    </div>
    <div class="win98-status-bar"><span>Ready</span><div class="win98-status-indicators"><div class="win98-indicator">NUM</div><div class="win98-indicator">CAPS</div></div></div>
    <div class="win98-resize-handle"></div>
  </div>

  <div id="win-results" style="display:none;" data-state="minimized" class="win98-window absolute top-32 left-[520px] w-[420px] shadow-xl">
    <div class="win98-titlebar"><div class="win98-title">RESULTS - PROGRAM MANAGER</div><div class="win98-controls"><div class="win98-button win98-minimize">_</div><div class="win98-button win98-maximize">□</div><div class="win98-button win98-close">×</div></div></div>
    <div class="win98-content">
      <div class="win98-menu-bar"><span class="win98-menu-item">Graph</span><span class="win98-menu-item">Odds</span></div>
      <div class="graph-box"><svg width="100%" height="100%"><polyline points="10,120 60,120 120,60" fill="none" stroke="black" /></svg></div>
      <div class="odds-box"><h3>Your Odds:</h3><span>--</span></div>
    </div>
    <div class="win98-status-bar"><span>Calculated</span><div class="win98-status-indicators"><div class="win98-indicator">NUM</div><div class="win98-indicator">CAPS</div></div></div>
    <div class="win98-resize-handle"></div>
  </div>

  <div class="absolute bottom-0 left-0 w-full h-10 bg-[#c0c0c0] border-t border-black flex items-center">
    <div class="bg-[#e0e0e0] border border-white px-3 py-1 ml-2 flex items-center gap-2 cursor-pointer"><img src="/icon-start.png" class="w-4 h-4" /><span class="font-bold text-sm">Start</span></div>
    <div id="taskbar-windows" class="flex-1 flex items-center gap-2 ml-2"></div>
    <div class="mr-4 text-sm">640×480</div>
  </div>

<script>
(function(){
 const desktop=document.querySelector('.desktop'); if(!desktop) return;
 const windows=[...document.querySelectorAll('.win98-window')];
 const taskbar=document.getElementById('taskbar-windows');
 const icons=[...document.querySelectorAll('.desktop-icon')];
 function bringToFront(win){ win.style.zIndex=String(Date.now()); }
 windows.forEach(win=>win.addEventListener('mousedown',()=>bringToFront(win)));
 let activeWin=null,dragStartX=0,dragStartY=0,dragStartLeft=0,dragStartTop=0;
 function onDragMove(e){ if(!activeWin)return; activeWin.style.left=(dragStartLeft+(e.clientX-dragStartX))+'px'; activeWin.style.top=(dragStartTop+(e.clientY-dragStartY))+'px'; }
 function onDragEnd(){ activeWin=null; document.removeEventListener('mousemove',onDragMove); document.removeEventListener('mouseup',onDragEnd); desktop.style.cursor='default'; }
 windows.forEach(win=>{ const title=win.querySelector('.win98-titlebar'); if(!title)return; title.addEventListener('mousedown',e=>{ e.preventDefault(); activeWin=win; bringToFront(win); const r=win.getBoundingClientRect(); dragStartX=e.clientX; dragStartY=e.clientY; dragStartLeft=r.left+scrollX; dragStartTop=r.top+scrollY; document.addEventListener('mousemove',onDragMove); document.addEventListener('mouseup',onDragEnd); desktop.style.cursor='move'; }); });
 function createTaskbarButton(win){ if(!taskbar||win.__taskButton)return; const titleEl=win.querySelector('.win98-title'); const btn=document.createElement('button'); btn.className='bg-[#e0e0e0] border border-white px-3 py-1 text-sm truncate max-w-[180px]'; btn.textContent=titleEl?titleEl.textContent.trim():'Window'; btn.onclick=()=>{ if(win.dataset.state==='minimized'){ win.style.display='block'; win.dataset.state='normal'; bringToFront(win);} else{ win.style.display='none'; win.dataset.state='minimized'; } }; taskbar.appendChild(btn); win.__taskButton=btn; }
 function minimizeWindow(win){ if(win.dataset.state==='minimized'){ win.style.display='block'; win.dataset.state='normal'; bringToFront(win);} else{ createTaskbarButton(win); win.style.display='none'; win.dataset.state='minimized'; } }
 function maximizeWindow(win){ if(win.dataset.state==='maximized'){ const b=win.__prevBounds; if(b){ win.style.left=b.left+'px'; win.style.top=b.top+'px'; win.style.width=b.width+'px'; win.style.height=b.height+'px'; } win.dataset.state='normal'; } else { const r=win.getBoundingClientRect(); win.__prevBounds={left:r.left+scrollX,top:r.top+scrollY,width:r.width,height:r.height}; const d=desktop.getBoundingClientRect(); win.style.left=d.left+scrollX+'px'; win.style.top=d.top+scrollY+'px'; win.style.width=d.width+'px'; win.style.height=(d.height-40)+'px'; win.dataset.state='maximized'; bringToFront(win);} }
 function closeWindow(win){ win.style.display='none'; win.dataset.state='closed'; if(win.__taskButton){ win.__taskButton.remove(); win.__taskButton=null; } }
 windows.forEach(win=>{ win.dataset.state=win.dataset.state||'normal'; if(win.dataset.state==='minimized'){ createTaskbarButton(win);}; const min=win.querySelector('.win98-minimize'); const max=win.querySelector('.win98-maximize'); const cls=win.querySelector('.win98-close'); if(min)min.onclick=e=>{e.stopPropagation();minimizeWindow(win);} ; if(max)max.onclick=e=>{e.stopPropagation();maximizeWindow(win);} ; if(cls)cls.onclick=e=>{e.stopPropagation();closeWindow(win);} ; });
 let selecting=false,selStartX=0,selStartY=0,selBox=null;
 function clearSelect(){ icons.forEach(ic=>ic.classList.remove('selected')); }
 function intersects(a,b){ return !(b.left>a.right||b.right<a.left||b.top>a.bottom||b.bottom<a.top); }
 desktop.addEventListener('mousedown',e=>{
  if(e.target.closest('.win98-window')||e.target.closest('.desktop-icon'))return;
  selecting=true; selStartX=e.clientX; selStartY=e.clientY; clearSelect(); selBox=document.createElement('div'); selBox.className='selection-box'; desktop.appendChild(selBox); selBox.style.left=selStartX+'px'; selBox.style.top=selStartY+'px';
  function onMove(ev){ if(!selecting)return; const x=ev.clientX,y=ev.clientY; const left=Math.min(x,selStartX),top=Math.min(y,selStartY); const w=Math.abs(x-selStartX),h=Math.abs(y-selStartY); selBox.style.left=left+'px'; selBox.style.top=top+'px'; selBox.style.width=w+'px'; selBox.style.height=h+'px'; const box=selBox.getBoundingClientRect(); icons.forEach(ic=>{ const r=ic.getBoundingClientRect(); if(intersects(r,box)) ic.classList.add('selected'); else ic.classList.remove('selected');}); }
  function onUp(){ selecting=false; document.removeEventListener('mousemove',onMove); document.removeEventListener('mouseup',onUp); if(selBox)selBox.remove(); }
  document.addEventListener('mousemove',onMove); document.addEventListener('mouseup',onUp);
 });
 // single‑click selection
icons.forEach(ic=>{
  ic.addEventListener('click',e=>{
    // prevent starting selection box
    e.stopPropagation();
    icons.forEach(i=>i.classList.remove('selected'));
    ic.classList.add('selected');
  });
});

// double-click open window
icons.forEach(ic=>ic.addEventListener('dblclick',()=>{
  const id = ic.dataset.window;
  if (!id) return;
  const w = document.getElementById(id);
  if (!w) return;
  // ensure taskbar button exists
  createTaskbarButton(w);
  // show window
  w.style.display = 'block';
  w.dataset.state = 'normal';
  bringToFront(w);
  // clear icon highlight
  icons.forEach(i => i.classList.remove('selected'));
}));
 let resizing=null,rsX=0,rsY=0,rW=0,rH=0;
 function onResMove(e){ if(!resizing)return; resizing.style.width=Math.max(260,rW+(e.clientX-rsX))+'px'; resizing.style.height=Math.max(315,rH+(e.clientY-rsY))+'px'; }
 function onResEnd(){ resizing=null; document.removeEventListener('mousemove',onResMove); document.removeEventListener('mouseup',onResEnd); }
 windows.forEach(win=>{ const h=win.querySelector('.win98-resize-handle'); if(!h)return; h.onmousedown=e=>{ e.stopPropagation(); resizing=win; const r=win.getBoundingClientRect(); rsX=e.clientX; rsY=e.clientY; rW=r.width; rH=r.height; document.addEventListener('mousemove',onResMove); document.addEventListener('mouseup',onResEnd); }; });
})();
</script>

</div>
